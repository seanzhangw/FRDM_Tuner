import numpy as np
import matplotlib.pyplot as plt

# Your data points
data_points = [380, 380, 380, 380, 380, 380, 381, 381, 381, 381, 381, 381, 381, 382, 382, 382, 382, 382, 382, 382, 382, 383, 383, 384, 382, 383, 384, 384, 384, 384, 384, 384, 384, 385, 385, 385, 385, 385, 385, 386, 386, 386, 386, 386, 386, 387, 386, 387, 386, 387, 387, 387, 387, 387, 388, 388, 388, 389, 388, 389, 389, 389, 389, 390, 390, 390, 390, 390, 390, 391, 391, 391, 391, 392, 391, 391, 392, 392, 392, 392, 392, 393, 393, 393, 393, 393, 394, 394, 394, 394, 394, 395, 395, 395, 395, 395, 395, 395, 396, 396, 396, 396, 396, 397, 396, 397, 397, 397, 398, 398, 397, 398, 398, 398, 399, 399, 399, 399, 398, 399, 399, 399, 399, 399, 399, 400, 400, 400, 400, 400, 400, 400, 400, 401, 400, 399, 400, 399, 400, 400, 400, 400, 401, 400, 401, 400, 401, 401, 400, 400, 400, 401, 401, 401, 401, 401, 401, 401, 401, 401, 401, 401, 400, 402, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 399, 399, 399, 399, 400, 399, 399, 400, 399, 399, 399, 399, 399, 399, 399, 399, 398, 399, 399, 398, 398, 398, 397, 398, 397, 397, 397, 395, 397, 396, 396, 396, 396, 395, 396, 396, 396, 395, 395, 395, 395, 395, 395, 396, 394, 395, 394, 394, 393, 394, 393, 393, 393, 394, 392, 392, 392, 392, 392, 392, 391, 391, 391, 391, 391, 390, 389, 390, 390, 390, 389, 389, 389, 388, 389, 388, 388, 388, 388, 387, 387, 388, 387, 387, 387, 387, 386, 386, 386, 386, 385, 385, 385, 385, 384, 384, 384, 384, 384, 384, 384, 384, 383, 383, 383, 383, 382, 383, 383, 383, 383, 382, 381, 381, 381, 381, 381, 381, 381, 381, 380, 380, 380, 380, 379, 379, 379, 379, 378, 378, 378, 378, 378, 377, 377, 377, 376, 376, 376, 376, 375, 375, 375, 375, 375, 374, 375, 374, 374, 374, 374, 374, 374, 374, 373, 374, 373, 373, 373, 373, 372, 373, 373, 373, 372, 372, 372, 370, 372, 372, 372, 372, 372, 372, 372, 372, 372, 371, 371, 371, 371, 371, 371, 370, 371, 371, 371, 372, 371, 371, 371, 371, 371, 371, 371, 371, 371, 371, 370, 370, 370, 370, 370, 370, 371, 370, 370, 370, 371, 371, 371, 370, 371, 370, 371, 371, 371, 371, 371, 371, 371, 371, 371, 371, 371, 372, 371, 371, 371, 372, 371, 372, 372, 371, 372, 372, 372, 372, 373, 373, 373, 372, 373, 373, 373, 373, 373, 373, 374, 374, 373, 374, 374, 374, 374, 374, 374, 374, 375, 375, 374, 375, 375, 375, 375, 376, 375, 376, 375, 376, 376, 376, 377, 376, 377, 377, 377, 378, 377, 377, 377, 377, 377, 378, 378, 378, 378, 378, 378, 379, 378, 379, 379, 379, 379, 379, 379, 380, 379, 380, 380, 380, 380, 380, 380, 380, 380, 381, 382, 381, 381, 381, 381, 382, 381, 382, 382, 382, 383, 383, 383, 383, 383, 384, 383, 383, 383, 384, 384, 384, 384, 384, 384, 385, 385, 385, 385, 385, 385, 385, 385, 385, 386, 386, 386, 386, 387, 386, 387, 387, 387, 387, 387, 387, 388, 388, 389, 388, 389, 389, 389, 389, 389, 389, 389, 390, 389, 389, 390, 391, 391, 391, 391, 391, 391, 391, 391, 391, 392, 391, 393, 393, 393, 392, 393, 393, 393, 393, 394, 393, 394, 394, 394, 394, 394, 395, 395, 395, 395, 395, 395, 396, 396, 396, 396, 396, 396, 396, 396, 396, 397, 397, 397, 397, 397, 397, 397, 397, 398, 398, 398, 397, 398, 398, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 400, 399, 399, 399, 399, 399, 399, 398, 399, 397, 399, 399, 399, 399, 398, 398, 398, 398, 398, 398, 398, 398, 398, 397, 398, 398, 397, 398, 398, 397, 398, 397, 397, 397, 397, 397, 397, 396, 397, 397, 397, 396, 396, 396, 395, 395, 396, 395, 396, 395, 395, 396, 394, 395, 394, 394, 394, 394, 393, 393, 394, 393, 393, 393, 393, 393, 392, 392, 392, 391, 392, 391, 391, 391, 391, 390, 390, 390, 390, 389, 390, 389, 389, 389, 389, 388, 388, 388, 389, 387, 387, 388, 387, 387, 387, 386, 386, 386, 386, 386, 386, 386, 385, 385, 385, 384, 385, 385, 385, 384, 384, 384, 385, 384, 384, 383, 383, 384, 383, 383, 382, 382, 383, 382, 382, 382, 382, 381, 381, 381, 381, 381, 380, 380, 380, 380, 380, 379, 380, 379, 379, 379, 379, 378, 378, 378, 378, 377, 377, 377, 377, 377, 377, 376, 376, 377, 376, 376, 376, 376, 375, 376, 376, 375, 375, 376, 375, 375, 375, 375, 375, 374, 375, 375, 375, 374, 374, 373, 374, 374, 374, 373, 374, 373, 373, 372, 373, 373, 372, 372, 372, 372, 372, 372, 371, 371, 371, 372, 371, 371, 371, 371, 370, 371, 370, 371, 370, 370, 370, 370, 370, 370, 371, 370, 370, 370, 370, 370, 370, 370, 370, 369, 369, 370, 370, 369, 370, 370, 369, 369, 370, 369, 369, 369, 370, 369, 369, 370, 370, 370, 370, 370, 370, 370, 370, 370, 370, 370, 370, 370, 370, 370, 371, 370, 370, 370, 371, 370, 370, 371, 371, 371, 371, 371, 371, 372, 372, 372, 371, 371, 371, 372, 372, 372, 372, 373, 371, 372, 373, 373, 373, 373, 374, 373, 375, 374, 374, 374, 374, 375, 375, 374, 375, 374, 374, 375, 375, 376, 376, 376, 376, 376, 375, 376, 375, 376, 377, 376, 377, 377, 377, 377, 377, 378, 378, 376, 378, 376, 378, 378, 379, 378, 378, 379, 379, 379, 379, 379, 380, 379, 379, 380, 379, 380, 380, 379, 380, 380, 381, 381, 381, 381, 381, 381, 382, 382, 382, 382, 383, 382, 383, 382, 383, 383, 383, 383, 383, 383, 383, 384, 384, 384, 384, 384, 385, 385, 385, 385, 386, 385, 386, 386, 385, 386, 386, 387, 387, 386, 387, 387, 387, 387, 387, 387, 388, 388, 388, 388, 389, 389, 389, 387, 389, 389, 389, 390, 390, 390, 390, 390, 391, 391, 391, 391, 392, 391, 391, 392, 392, 392, 393, 392, 392, 393, 393, 393, 393, 393, 394, 394, 395, 394, 394, 394, 395, 394, 395, 395, 395, 395, 396, 397, 396, 396, 396, 396, 396, 397, 397, 397, 397, 397, 397, 397, 397, 397, 397, 397, 397, 398, 398, 398, 398, 398, 398, 398, 398, 398, 398, 397, 399, 398, 398, 398, 398, 399, 399, 398, 398, 398, 399, 398, 398, 398, 398, 399, 398, 397, 398, 398, 398, 398, 398, 398, 398, 398, 398, 398, 398, 398, 398, 396, 398, 397, 397, 397, 397, 397, 397, 397, 397, 397, 397, 397, 396, 396, 396, 396, 396, 396, 395, 396, 395, 396, 396, 395, 395, 395, 395, 395, 395, 394, 395, 394, 394, 394, 394, 393, 394, 393, 394, 393, 393, 393, 393, 392, 393, 392, 392, 392, 392, 391, 391, 391, 390, 390, 390, 390, 390, 390, 390, 389, 389, 389, 389, 389, 388, 388, 388, 388, 388, 387, 388, 387, 387, 386, 387, 386, 386, 386, 386, 386, 386, 385, 385, 385, 385, 385, 385, 385, 384, 384, 383, 384, 383, 384, 383, 383, 383, 383, 383, 383, 382, 382, 382, 381, 382, 382, 381, 381, 381, 381, 381, 380, 381, 380, 380, 380, 380, 379, 379, 379, 379, 377, 379, 378, 378, 378, 378, 377, 378, 377, 377, 377, 376, 376, 377, 376, 376, 376, 376, 375, 376, 375, 375, 375, 375, 374, 374, 374, 373, 373, 373, 373, 373, 372, 372, 372, 372, 372, 372, 371, 371, 371, 371, 371, 371, 371, 371, 371, 371, 371, 370, 371, 371, 370, 371, 370, 370, 370, 370, 370, 370, 370, 370, 370, 369, 370, 369, 370, 370, 370, 370, 370, 370, 370, 369, 370, 370, 370, 370, 370, 369, 370, 369, 370, 370, 370, 370, 370, 370, 370, 370, 370, 371, 370, 370, 370, 370, 370, 370, 370, 370, 370, 371, 370, 371, 371, 371, 370, 371, 371, 371, 371, 372, 371, 371, 371, 371, 372, 372, 371, 371, 371, 372, 372, 372, 372, 373, 372, 373, 372, 373, 373, 373, 373, 374, 373, 374, 374, 374, 374, 374, 374, 374, 375, 374, 375, 375, 374, 375, 375, 375, 376, 376, 376, 377, 376, 377, 377, 377, 376, 377, 377, 377, 377, 378, 377, 378, 377, 378, 378, 378, 378, 378, 378, 379, 379, 380, 379, 380, 379, 379, 380, 380, 380, 381, 380, 381, 380, 381, 381, 381, 381, 382, 381, 382, 382, 382, 382, 383, 382, 383, 383, 382, 383, 383, 383, 384, 383, 384, 384, 384, 384, 384, 385, 385, 384, 385, 385, 385, 386, 386, 385, 386, 385, 386, 386, 386, 386, 387, 387, 387, 387, 388, 388, 388, 388, 389, 389, 389, 389, 389, 389, 389, 389, 391, 390, 389, 390, 390, 390, 390, 391, 391, 391, 391, 391, 391, 392, 392, 392, 393, 393, 393, 393, 394, 392, 394, 394, 394, 394, 395, 395, 394, 395, 395, 395, 395, 396, 396, 396, 396, 396, 397, 397, 397, 397, 397, 397, 397, 397, 398, 398, 398, 398, 399, 398, 399, 398, 398, 398, 399, 399, 400, 399, 399, 399, 399, 399, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 399, 399, 399, 400, 399, 399, 399, 399, 399, 400, 399, 399, 399, 399, 399, 399, 398, 398, 398, 398, 398, 398, 398, 398, 398, 397, 397, 397, 397, 397, 396, 396, 396, 396, 396, 396, 396, 395, 396, 396, 395, 395, 395, 395, 395, 394, 394, 395, 394, 394, 393, 393, 394, 393, 393, 394, 392, 392, 392, 391, 390, 392, 391, 391, 392, 390, 391, 390, 391, 390, 390, 390, 389, 389, 388, 389, 388, 389, 389, 387, 388, 386, 387, 387, 388, 387, 386, 387, 386, 386, 386, 386, 386, 386, 385, 386, 385, 385, 385, 384, 385, 384, 384, 384, 384, 384, 383, 384, 383, 383, 383, 383, 383, 382, 382, 383, 382, 382, 382, 381, 381, 381, 380, 381, 381, 381, 380, 380, 380, 379, 380, 379, 379, 379, 379, 379, 379, 378, 378, 378, 377, 377, 377, 377, 377, 377, 376, 378, 376, 377, 376, 376, 394, 394, 395, 395, 395, 395, 395, 396, 396, 396, 397, 396, 396, 397, 397, 397, 396, 397, 397, 397, 397, 398, 397, 398, 398, 398, 398, 398, 388, 398, 398, 398, 398, 397, 398, 399, 398, 398, 398, 398, 398, 398, 398, 398, 398, 399, 399, 400, 399, 399, 399, 399, 399, 399, 399, 399, 401, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 398, 399, 398, 398, 399, 399, 398, 398, 397, 398, 398, 398, 397, 397, 397, 397, 396, 397, 397, 398, 396, 397, 396, 396, 396, 396, 396, 396, 395, 396, 395, 395, 395, 395, 396, 395, 394, 395, 395, 394, 394, 394, 394, 394, 393, 393, 393, 393, 393, 393, 393, 392, 392, 393, 392, 392, 392, 392, 391, 390, 392, 390, 390, 390, 390, 390, 389, 389, 389, 389, 388, 388, 389, 388, 388, 383, 388, 388, 388, 387, 387, 387, 387, 387, 386, 386, 386, 387, 386, 385, 385, 385, 384, 385, 384, 384, 384, 384, 383, 383, 383, 384, 384, 382, 383, 383, 383, 382, 383, 381, 381, 382, 381, 381, 381, 381, 381, 392, 380, 380, 380, 380, 380, 380, 379, 379, 378, 379, 378, 378, 378, 378, 378, 378, 377, 378, 377, 377, 377, 376, 377, 377, 376, 376, 377, 375, 375, 375, 375, 375, 367, 375, 375, 374, 374, 373, 374, 374, 374, 374, 373, 373, 373, 373, 373, 373, 372, 373, 372, 373, 372, 372, 372, 374, 372, 371, 371, 371, 371, 371, 369, 371, 371, 370, 371, 370, 370, 370, 370, 370, 370, 370, 370, 368, 370, 370, 370, 369, 370, 370, 370, 370, 370, 370, 370, 369, 370, 369, 369, 370, 370, 369, 370, 370, 370, 370, 369, 369, 369, 370, 370, 370, 370, 369, 370, 371, 369, 370, 370, 370, 377, 371, 370, 370, 370, 370, 371, 371, 371, 371, 371, 371, 371, 371, 371, 371, 371, 371, 372, 372]
plt.plot(data_points)
# Sampling rate estimation (assuming samples are taken at regular time intervals)
sample_rate = 189000  # This is an assumption, replace with your actual sample rate in Hz

# Apply a window function (Hanning window)
windowed_data = data_points * np.hanning(len(data_points))

# Perform FFT
fft_result = np.fft.fft(windowed_data)
frequencies = np.fft.fftfreq(len(fft_result), 1/sample_rate)

# Get the power spectrum (magnitude squared of FFT results)
power_spectrum = np.abs(fft_result)**2

# Find the dominant frequency (ignore the zero frequency term)
dominant_frequency = frequencies[np.argmax(power_spectrum[1:]) + 1]  # +1 to correct the index for ignoring DC

# Plotting
plt.figure(figsize=(10, 5))
plt.plot(frequencies[:len(data_points)//2], power_spectrum[:len(data_points)//2])
plt.title('Frequency Spectrum')
plt.xlabel('Frequency (Hz)')
plt.ylabel('Power')
plt.grid(True)
plt.show()

print(f"Dominant Frequency: {dominant_frequency} Hz")
