import numpy as np
import matplotlib.pyplot as plt

# Your data points
data_points = [437, 436, 436, 437, 437, 437, 437, 437, 437, 437, 437, 437, 437, 437, 438, 438, 436, 438, 438, 438, 438, 438, 438, 439, 439, 439, 439, 439, 439, 439, 439, 439, 440, 440, 440, 440, 440, 440, 440, 441, 441, 441, 441, 441, 441, 441, 441, 442, 442, 442, 442, 442, 442, 443, 443, 443, 443, 443, 444, 443, 444, 444, 444, 444, 444, 444, 445, 445, 445, 445, 445, 446, 445, 446, 446, 446, 446, 446, 447, 447, 447, 447, 447, 447, 447, 448, 448, 448, 448, 448, 449, 448, 449, 449, 449, 449, 449, 449, 449, 450, 450, 450, 450, 450, 450, 451, 451, 451, 451, 452, 451, 452, 452, 452, 452, 452, 452, 453, 453, 453, 453, 453, 454, 454, 454, 454, 455, 455, 455, 455, 455, 455, 456, 456, 456, 456, 457, 457, 458, 458, 458, 458, 457, 459, 458, 459, 459, 460, 460, 460, 460, 460, 460, 461, 461, 461, 462, 462, 462, 462, 462, 462, 463, 463, 463, 464, 464, 464, 464, 464, 464, 464, 464, 465, 465, 465, 465, 465, 465, 466, 465, 466, 467, 467, 467, 467, 468, 468, 468, 468, 469, 469, 469, 469, 470, 470, 470, 470, 471, 470, 471, 471, 471, 471, 472, 471, 471, 471, 471, 471, 471, 472, 471, 470, 471, 472, 472, 472, 472, 472, 471, 471, 472, 472, 472, 471, 472, 471, 471, 471, 471, 472, 471, 471, 471, 471, 471, 471, 471, 471, 472, 471, 471, 471, 471, 471, 470, 471, 470, 471, 470, 470, 470, 470, 470, 469, 470, 469, 470, 469, 469, 469, 469, 468, 469, 468, 468, 468, 468, 468, 468, 467, 468, 467, 467, 467, 467, 466, 466, 466, 466, 466, 466, 466, 465, 465, 465, 465, 465, 464, 464, 464, 464, 463, 463, 463, 463, 462, 463, 462, 462, 462, 462, 462, 462, 461, 462, 461, 461, 461, 461, 461, 460, 460, 460, 460, 460, 460, 459, 459, 458, 459, 459, 458, 458, 458, 457, 457, 457, 457, 457, 457, 457, 456, 456, 456, 456, 456, 455, 455, 455, 454, 455, 454, 454, 454, 454, 453, 453, 453, 453, 452, 452, 452, 451, 452, 451, 451, 450, 450, 450, 450, 450, 449, 449, 449, 449, 449, 448, 448, 448, 448, 447, 447, 447, 447, 447, 446, 446, 446, 446, 446, 445, 445, 445, 445, 445, 444, 444, 444, 444, 444, 443, 443, 443, 443, 443, 442, 442, 442, 442, 442, 442, 441, 441, 440, 441, 440, 440, 440, 440, 440, 439, 441, 439, 439, 439, 439, 439, 438, 439, 438, 438, 439, 438, 438, 438, 438, 438, 438, 437, 438, 437, 437, 437, 437, 437, 437, 437, 436, 437, 437, 437, 437, 437, 436, 436, 437, 437, 437, 436, 436, 436, 436, 437, 436, 436, 436, 436, 436, 436, 437, 437, 437, 437, 436, 437, 437, 437, 437, 437, 437, 437, 437, 437, 437, 437, 437, 438, 437, 438, 438, 438, 438, 438, 438, 438, 438, 438, 439, 439, 439, 439, 439, 439, 439, 439, 439, 439, 439, 440, 440, 440, 440, 440, 440, 440, 440, 440, 441, 441, 441, 441, 441, 441, 441, 442, 442, 442, 442, 442, 442, 443, 443, 443, 442, 443, 444, 444, 443, 444, 444, 444, 443, 444, 445, 445, 445, 445, 445, 445, 445, 446, 446, 446, 446, 446, 446, 447, 447, 447, 447, 447, 447, 448, 448, 448, 448, 448, 448, 448, 449, 449, 449, 449, 449, 449, 449, 450, 450, 450, 450, 450, 450, 450, 450, 451, 451, 451, 451, 451, 451, 452, 452, 452, 452, 452, 453, 453, 453, 453, 454, 454, 454, 454, 454, 454, 455, 455, 455, 455, 456, 456, 456, 456, 456, 456, 457, 457, 457, 457, 457, 458, 458, 459, 459, 459, 459, 459, 459, 460, 460, 461, 461, 461, 461, 461, 462, 462, 462, 462, 462, 462, 463, 463, 463, 463, 463, 463, 464, 464, 464, 464, 464, 464, 465, 465, 465, 466, 465, 465, 466, 466, 466, 466, 467, 466, 466, 467, 466, 466, 466, 466, 465, 465, 465, 466, 465, 465, 465, 465, 465, 465, 465, 466, 466, 466, 465, 465, 466, 466, 466, 467, 466, 466, 466, 467, 467, 467, 467, 467, 467, 468, 467, 468, 467, 467, 468, 468, 468, 467, 468, 468, 468, 468, 468, 468, 468, 468, 469, 468, 468, 468, 468, 468, 468, 468, 468, 468, 468, 468, 468, 468, 467, 468, 467, 467, 468, 467, 467, 467, 467, 467, 467, 467, 467, 467, 466, 466, 466, 466, 466, 465, 465, 465, 465, 465, 465, 465, 465, 465, 465, 464, 464, 464, 464, 464, 463, 463, 463, 463, 463, 463, 463, 463, 462, 462, 462, 462, 462, 462, 461, 461, 461, 460, 461, 461, 461, 460, 460, 460, 460, 460, 459, 459, 459, 459, 458, 458, 458, 458, 458, 458, 457, 457, 457, 457, 457, 456, 456, 456, 456, 456, 455, 455, 455, 455, 454, 454, 454, 454, 453, 454, 453, 453, 453, 452, 452, 452, 452, 451, 452, 451, 451, 451, 450, 451, 450, 450, 449, 449, 449, 449, 449, 448, 448, 448, 448, 447, 448, 447, 447, 446, 446, 445, 446, 445, 445, 446, 445, 445, 445, 444, 444, 444, 443, 443, 443, 443, 443, 443, 442, 442, 442, 442, 442, 441, 441, 441, 441, 441, 441, 440, 440, 439, 440, 439, 440, 439, 439, 439, 439, 439, 439, 438, 438, 438, 438, 438, 438, 437, 438, 437, 437, 437, 437, 437, 437, 437, 437, 436, 436, 436, 436, 436, 436, 436, 436, 435, 436, 435, 436, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 435, 436, 435, 436, 436, 436, 436, 436, 436, 436, 436, 436, 436, 437, 435, 437, 437, 437, 437, 437, 437, 458, 459, 459, 459, 458, 459, 460, 458, 458, 458, 458, 458, 458, 458, 457, 457, 457, 457, 457, 457, 457, 457, 457, 457, 457, 456, 456, 456, 456, 456, 455, 455, 455, 455, 455, 455, 455, 454, 454, 454, 454, 454, 454, 453, 453, 453, 453, 453, 453, 453, 452, 452, 452, 453, 452, 452, 451, 451, 451, 452, 450, 449, 450, 450, 450, 449, 450, 449, 449, 449, 449, 449, 448, 448, 447, 448, 448, 448, 447, 447, 447, 447, 447, 446, 446, 444, 446, 445, 445, 445, 447, 445, 445, 445, 444, 444, 444, 444, 443, 443, 443, 443, 443, 442, 442, 440, 442, 441, 440, 441, 440, 441, 441, 440, 440, 439, 440, 439, 443, 439, 439, 438, 438, 438, 438, 438, 438, 437, 437, 437, 437, 436, 436, 436, 436, 436, 435, 435, 435, 435, 435, 435, 434, 434, 434, 434, 432, 433, 433, 433, 432, 432, 432, 432, 431, 431, 432, 431, 431, 431, 431, 431, 431, 431, 431, 430, 431, 430, 430, 430, 430, 430, 430, 429, 429, 429, 429, 429, 429, 429, 428, 428, 428, 428, 428, 427, 427, 427, 428, 427, 427, 427, 427, 426, 425, 426, 426, 426, 425, 426, 426, 425, 425, 425, 425, 426, 425, 425, 425, 425, 425, 425, 425, 425, 425, 425, 425, 425, 425, 425, 425, 426, 425, 425, 425, 425, 426, 425, 426, 426, 426, 426, 426, 426, 426, 426, 426, 426, 427, 427, 427, 427, 427, 428, 428, 427, 427, 428, 429, 428, 428, 428, 428, 429, 429, 429, 428, 429, 429, 429, 429, 429, 430, 428, 430, 430, 430, 430, 430, 431, 431, 431, 430, 431, 431, 431, 431, 432, 432, 432, 432, 432, 432, 432, 432, 432, 432, 432, 433, 433, 433, 433, 433, 435, 433, 433, 434, 434, 434, 434, 434, 433, 434, 434, 435, 435, 436, 435, 435, 436, 435, 436, 435, 436, 436, 436, 436, 436, 437, 437, 437, 437, 437, 437, 438, 438, 437, 438, 438, 438, 438, 438, 438, 439, 438, 439, 439, 439, 439, 440, 439, 439, 439, 440, 440, 440, 440, 440, 440, 441, 440, 441, 441, 441, 441, 441, 441, 441, 441, 442, 442, 442, 443, 443, 444, 443, 444, 444, 445, 444, 444, 445, 445, 445, 445, 446, 446, 446, 446, 446, 446, 446, 447, 448, 447, 448, 448, 447, 448, 449, 449, 443, 449, 449, 450, 449, 450, 449, 451, 450, 451, 450, 452, 450, 452, 452, 452, 453, 453, 453, 453, 453, 454, 453, 454, 454, 454, 455, 455, 455, 455, 455, 456, 456, 456, 458, 456, 457, 457, 457, 458, 458, 459, 458, 458, 458, 458, 458, 458, 458, 459, 459, 458, 459, 458, 459, 458, 459, 460, 459, 459, 459, 459, 458, 459, 459, 458, 458, 458, 460, 458, 458, 458, 459, 459, 458, 458, 459, 459, 458, 458, 458, 458, 457, 458, 456, 458, 457, 457, 457, 457, 458, 457, 457, 457, 457, 456, 456, 455, 456, 456, 456, 455, 456, 455, 455, 455, 455, 455, 455, 455, 454, 454, 454, 454, 454, 454, 453, 453, 453, 453, 453, 453, 452, 454, 452, 452, 452, 451, 451, 451, 451, 451, 450, 450, 450, 450, 449, 449, 449, 449, 449, 448, 447, 448, 447, 448, 447, 447, 447, 447, 445, 446, 445, 446, 443, 445, 445, 445, 444, 444, 445, 444, 444, 444, 445, 443, 444, 443, 443, 443, 443, 442, 442, 442, 442, 441, 442, 442, 442, 441, 441, 441, 440, 440, 439, 440, 440, 440, 439, 439, 438, 439, 439, 439, 440, 438, 438, 438, 438, 438, 438, 437, 437, 435, 437, 437, 437, 436, 436, 436, 435, 435, 436, 435, 434, 435, 434, 434, 434, 435, 434, 434, 434, 434, 434, 433, 433, 432, 433, 432, 432, 432, 432, 432, 432, 431, 431, 430, 431, 429, 429, 429, 428, 428, 427, 427, 427, 426, 426, 426, 426, 426, 425, 426, 425, 425, 425, 425, 424, 424, 424, 424, 424, 425, 422, 424, 424, 423, 423, 423, 423, 423, 424, 419, 423, 423, 423, 422, 422, 423, 423, 423, 424, 423, 423, 423, 422, 423, 423, 423, 423, 422, 423, 423, 423, 422, 422, 422, 423, 423, 423, 423, 423, 423, 424, 423, 424, 424, 424, 423, 424, 423, 424, 424, 424, 424, 424, 424, 424, 425, 424, 424, 424, 425, 424, 425, 425, 425, 425, 425, 426, 426, 426, 426, 426, 426, 426, 426, 427, 426, 427, 427, 426, 427, 427, 427, 428, 428, 427, 428, 428, 429, 429, 429, 429, 429, 429, 429, 428, 429, 430, 430, 431, 431, 431, 431, 431, 431, 431, 431, 431, 431, 431, 431, 432, 431, 432, 432, 433, 433, 432, 434, 433, 433, 434, 434, 430, 434, 434, 434, 434, 434, 435, 435, 436, 436, 435, 435, 435, 435, 434, 436, 436, 436, 436, 436, 437, 437, 437, 437, 438, 437, 438, 438, 438, 438, 438, 438, 439, 439, 439, 439, 439, 439, 440, 440, 440, 440, 440, 441, 440, 441, 441, 441, 441, 442, 442, 442, 442, 442, 443, 443, 443, 443, 444, 444, 444, 444, 444, 445, 445, 445, 445, 445, 446, 445, 446, 447, 446, 447, 447, 447, 447, 448, 448, 448, 448, 448, 449, 449, 450, 449, 449, 450, 450, 449, 451, 450, 451, 450, 451, 451, 451, 451, 452, 452, 452, 452, 452, 452, 453, 453, 453, 453, 454, 453, 453, 454, 454, 454, 454, 454, 454, 455, 455, 455, 455, 455, 451, 455, 455, 456, 456, 456, 456, 456, 457, 457, 457, 456, 456, 457, 456, 457, 456, 457, 457, 457, 457, 457, 457, 458, 457, 457, 457, 458, 457, 458, 458, 458, 458, 457, 458, 457, 457, 457, 459, 457, 457, 457, 458, 457, 457, 457, 457, 456, 457, 457, 457, 457, 456, 457, 456, 456, 456, 456, 456, 456, 456, 457, 456, 456, 455, 456, 456, 455, 455, 455, 455, 451, 454, 454, 454, 454, 454, 454, 453, 453, 453, 453, 453, 453, 452, 452, 452, 452, 452, 451, 451, 451, 451, 452, 450, 451, 450, 451, 450, 450, 450, 451, 450, 449, 449, 449, 449, 449, 449, 448, 448, 447, 448, 447, 447, 447, 447, 447, 446, 447, 446, 446, 447, 446, 447, 446, 445, 445, 445, 446, 445, 445, 444, 444, 444, 444, 444, 444, 443, 443, 443, 444, 443, 442, 442, 441, 442, 441, 442, 441, 441, 446, 441, 440, 440, 439, 440, 440, 440, 439, 439, 439, 438, 438, 438, 439, 438, 438, 438, 437, 436, 436, 436, 436, 437, 436, 435, 435, 435, 435, 436, 434, 434, 434, 434, 433, 434, 433, 432, 432, 432, 432, 432, 432, 432, 432, 431, 431, 430, 431]
plt.plot(data_points)
# Sampling rate estimation (assuming samples are taken at regular time intervals)
sample_rate = 40000  # This is an assumption, replace with your actual sample rate in Hz

# Apply a window function (Hanning window)
windowed_data = data_points * np.hanning(len(data_points))

# Perform FFT
fft_result = np.fft.fft(windowed_data)
frequencies = np.fft.fftfreq(len(fft_result), 1/sample_rate)

# Get the power spectrum (magnitude squared of FFT results)
power_spectrum = np.abs(fft_result)**2

# Find the dominant frequency (ignore the zero frequency term)
dominant_frequency = frequencies[np.argmax(power_spectrum[1:]) + 1]  # +1 to correct the index for ignoring DC

# Plotting
plt.figure(figsize=(10, 5))
plt.plot(frequencies[:len(data_points)//2], power_spectrum[:len(data_points)//2])
plt.title('Frequency Spectrum')
plt.xlabel('Frequency (Hz)')
plt.ylabel('Power')
plt.grid(True)
plt.show()

print(f"Dominant Frequency: {dominant_frequency} Hz")
